require.config({paths:{BsMultiselect:M.cfg.wwwroot+"/mod/goone/js/bootstrap-multiselect"}});define ("mod_goone/browser",["jquery","BsMultiselect","core/templates","core/str","core/notification","core/ajax","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g,h){var i={offSet:0,initial:0};d.get_string("expand","core",i.cleartext);i.init=function(){a(document).ready(function(){a("#sort").change(function(){i.changeFilter()});a("#provider").multiselect({inheritClass:!0,enableFiltering:!0,enableCaseInsensitiveFiltering:!0,maxHeight:350,buttonWidth:"15rem",includeResetOption:!0,resetText:i.cleartext,nonSelectedText:"Any",onChange:function onChange(){i.changeFilter()}});a("#tag").multiselect({inheritClass:!0,enableFiltering:!0,enableCaseInsensitiveFiltering:!0,maxHeight:350,buttonWidth:"15rem",includeResetOption:!0,resetText:i.cleartext,nonSelectedText:"Any",onChange:function onChange(){i.changeFilter()}});a("#language").multiselect({inheritClass:!0,enableFiltering:!0,enableCaseInsensitiveFiltering:!0,maxHeight:350,buttonWidth:"15rem",includeResetOption:!0,resetText:i.cleartext,nonSelectedText:"Any",onChange:function onChange(){i.changeFilter()}});a("#type").multiselect({inheritClass:!0,enableFiltering:!0,enableCaseInsensitiveFiltering:!0,maxHeight:350,buttonWidth:"15rem",includeResetOption:!0,resetText:i.cleartext,nonSelectedText:"Any",onChange:function onChange(){i.changeFilter()}});a(".multiselect-reset").on("click",function(){i.changeFilter()});i.loadResults(a("#type").val(),a("#tag").val(),a("#language").val(),a("#provider").val(),a("#keyword").val(),a("#sort").val(),i.offSet)});a(document).on("click","#lomodal",function(){var b=a(this).data("name"),i=a(this).data("id");return g.create({title:b,type:g.types.SAVE_CANCEL,large:!0}).done(function(a){f.call([{methodname:"mod_goone_get_modal",args:{loid:i},done:function done(b){a.setBody(c.render("mod_goone/modal",JSON.parse(b.result)))},fail:e.exception}]);a.setSaveButtonText(d.get_string("submit","core"));a.getRoot().on(h.save,function(){try{window.opener.$("#id_loid").val(i);window.opener.$("#id_loname").val(b)}catch(a){}window.close();return!1});a.show()})});a("#load-more").click(function(){i.offSet=i.offSet+20;i.loadResults(a("#type").val(),a("#tag").val(),a("#language").val(),a("#provider").val(),a("#keyword").val(),a("#sort").val(),i.offSet)});a("#keyword").keypress(function(b){if(13==b.which){a("#keyword").submit();i.changeFilter()}})};i.changeFilter=function(){if(0==i.initial){a("#sort").val("relevance");i.initial=1}i.offSet=0;a("#goone-browser-results").html("");i.loadResults(a("#type").val(),a("#tag").val(),a("#language").val(),a("#provider").val(),a("#keyword").val(),a("#sort").val(),i.offSet)};i.loadResults=function(b,c,d,g,h,j,k){a("#spinny").show();f.call([{methodname:"mod_goone_get_hits",args:{type:b,tag:c,language:d,provider:g,keyword:h,sort:j,offset:k},done:function done(e){a("#goone-browser-results").append(e.result);a("#spinny").hide();a("#latest-go1-result h2").html(a(".go1-result").last().html());var f=parseInt(a("#total-hits").text(),10);if(20>=f||k>=f-20){a("#load-more-div").hide();a("#end-of-results").show()}else{a("#load-more-div").show();a("#end-of-results").hide()}if(b+""!=a("#type").val()+""||c+""!=a("#tag").val()+""||d+""!=a("#language").val()+""||g+""!=a("#provider").val()+""){i.changeFilter()}},fail:e.exception}])};return i});
//# sourceMappingURL=browser.min.js.map
